
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>02. Double DQN &#8212; ZC Notebook</title>
  <script>
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=1e1de1a1873e13ef5536" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1e1de1a1873e13ef5536" rel="stylesheet">

  
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/6.1.2/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
    <link rel="stylesheet" type="text/css" href="../_static/extra.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1e1de1a1873e13ef5536">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/sphinx_highlight.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/design-tabs.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'drlearn/double_q';</script>
    <link rel="shortcut icon" href="../_static/favicon.svg"/>
    <link rel="author" title="About these documents" href="../about.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="03. Prioritized Experience Replay (PER)" href="per.html" />
    <link rel="prev" title="01. DQN" href="dqn.html" /> 
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="docsearch:language" content="en">  
<style type="text/css">
  ul.ablog-archive {
    list-style: none;
    overflow: auto;
    margin-left: 0px;
  }
  ul.ablog-archive li {
    float: left;
    margin-right: 5px;
    font-size: 80%;
  }
  ul.postlist a {
    font-style: italic;
  }
  ul.postlist-style-disc {
    list-style-type: disc;
  }
  ul.postlist-style-none {
    list-style-type: none;
  }
  ul.postlist-style-circle {
    list-style-type: circle;
  }
</style>

  </head>
  
  
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="180" data-default-mode="">

  
  <input type="checkbox" class="sidebar-toggle" name="__primary" id="__primary">
  <label class="overlay overlay-primary" for="__primary"></label>

  
  <input type="checkbox" class="sidebar-toggle" name="__secondary" id="__secondary">
  <label class="overlay overlay-secondary" for="__secondary"></label>

  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
      
<form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this site..." aria-label="Search this site..." autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false">
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
    </div>
  </div>

  
  <nav class="bd-header navbar navbar-expand-lg bd-navbar" id="navbar-main"><div class="bd-header__inner bd-page-width">
  <label class="sidebar-toggle primary-toggle" for="__primary">
      <span class="fa-solid fa-bars"></span>
  </label>
  <div id="navbar-start">
    
    
  


<a class="navbar-brand logo" href="../index.html">

  
  
  
  
  
  
  

  
    <img src="../_static/logo.png" class="logo__image only-light" alt="Logo image">
    <img src="../_static/logo-dark.png" class="logo__image only-dark" alt="Logo image">
  
  
    <p class="title logo__title">ZC's Notebook</p>
  
</a>
    
  </div>

  
  <div class="col-lg-9 navbar-header-items">
    <div id="navbar-center" class="mr-auto">
      
      <div class="navbar-center-item">
        <nav class="navbar-nav">
    <p class="sidebar-header-items__title" role="heading" aria-level="1" aria-label="Site Navigation">
        Site Navigation
    </p>
    <ul id="navbar-main-elements" class="navbar-nav">
        
                <li class="nav-item current active">
                    <a class="nav-link" href="index.html">
                        强化学习
                    </a>
                </li>
                

                <li class="nav-item">
                    <a class="nav-link" href="../science/index.html">
                        科学计算
                    </a>
                </li>
                

                <li class="nav-item">
                    <a class="nav-link" href="../blog.html">
                        博客
                    </a>
                </li>
                

                <li class="nav-item">
                    <a class="nav-link" href="../collection.html">
                        网页收藏
                    </a>
                </li>
                

                <li class="nav-item">
                    <a class="nav-link" href="../about.html">
                        关于本站
                    </a>
                </li>
                
            <div class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                    More
                </button>
                <div class="dropdown-menu">
                    
            <li class="nav-item">
                <a class="nav-link nav-external" href="https://course.rs/about-book.html">Rust语言圣经<i class="fa-solid fa-up-right-from-square"></i></a>
            </li>

            <li class="nav-item">
                <a class="nav-link nav-external" href="https://rust-book.junmajinlong.com/">Rust入门秘籍<i class="fa-solid fa-up-right-from-square"></i></a>
            </li>

            <li class="nav-item">
                <a class="nav-link nav-external" href="https://nomicon.purewhite.io/intro.html">Rust 秘典<i class="fa-solid fa-up-right-from-square"></i></a>
            </li>
                </div>
            </div>
            
    </ul>
</nav>
      </div>
      
    </div>

    <div id="navbar-end">
      <div class="navbar-end-item navbar-end__search-button-container">
        
<button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" data-toggle="tooltip">
  <i class="fa-solid fa-magnifying-glass"></i>
</button>
      </div>
      
      <div class="navbar-end-item">
        <span class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" data-toggle="tooltip">
    <a class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></a>
    <a class="theme-switch" data-mode="dark"><i class="fa-regular fa-moon"></i></a>
    <a class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></a>
</span>
      </div>
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          <a href="https://github.com/zclab" title="GitHub" class="nav-link" rel="noopener" target="_blank" data-toggle="tooltip"><span><i class="fa-brands fa-square-github"></i></span>
            <label class="sr-only">GitHub</label></a>
        </li>
      </ul>
      </div>
      
    </div>
  </div>


  
  <div class="search-button-container--mobile">
<button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" data-toggle="tooltip">
  <i class="fa-solid fa-magnifying-glass"></i>
</button>
  </div>

  
  <label class="sidebar-toggle secondary-toggle" for="__secondary">
      <span class="fa-solid fa-outdent"></span>
  </label>
  

</div>
  </nav>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        
  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
      
      <div class="navbar-center-item">
        <nav class="navbar-nav">
    <p class="sidebar-header-items__title" role="heading" aria-level="1" aria-label="Site Navigation">
        Site Navigation
    </p>
    <ul id="navbar-main-elements" class="navbar-nav">
        
                <li class="nav-item current active">
                    <a class="nav-link" href="index.html">
                        强化学习
                    </a>
                </li>
                

                <li class="nav-item">
                    <a class="nav-link" href="../science/index.html">
                        科学计算
                    </a>
                </li>
                

                <li class="nav-item">
                    <a class="nav-link" href="../blog.html">
                        博客
                    </a>
                </li>
                

                <li class="nav-item">
                    <a class="nav-link" href="../collection.html">
                        网页收藏
                    </a>
                </li>
                

                <li class="nav-item">
                    <a class="nav-link" href="../about.html">
                        关于本站
                    </a>
                </li>
                
            <div class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                    More
                </button>
                <div class="dropdown-menu">
                    
            <li class="nav-item">
                <a class="nav-link nav-external" href="https://course.rs/about-book.html">Rust语言圣经<i class="fa-solid fa-up-right-from-square"></i></a>
            </li>

            <li class="nav-item">
                <a class="nav-link nav-external" href="https://rust-book.junmajinlong.com/">Rust入门秘籍<i class="fa-solid fa-up-right-from-square"></i></a>
            </li>

            <li class="nav-item">
                <a class="nav-link nav-external" href="https://nomicon.purewhite.io/intro.html">Rust 秘典<i class="fa-solid fa-up-right-from-square"></i></a>
            </li>
                </div>
            </div>
            
    </ul>
</nav>
      </div>
      
      </div>
    

    
    
    <div class="sidebar-header-items__end">
      
      <div class="navbar-end-item">
        <span class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" data-toggle="tooltip">
    <a class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></a>
    <a class="theme-switch" data-mode="dark"><i class="fa-regular fa-moon"></i></a>
    <a class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></a>
</span>
      </div>
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          <a href="https://github.com/zclab" title="GitHub" class="nav-link" rel="noopener" target="_blank" data-toggle="tooltip"><span><i class="fa-brands fa-square-github"></i></span>
            <label class="sr-only">GitHub</label></a>
        </li>
      </ul>
      </div>
      
    </div>
    
  </div>

  
  <div class="sidebar-start-items sidebar-primary__section">
    <div class="sidebar-start-items__item"><nav class="bd-links" id="bd-docs-nav" aria-label="Section navigation">
  <p class="bd-links__title" role="heading" aria-level="1">
    Section Navigation
  </p>
  <div class="bd-toc-item navbar-nav">
    <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="A2C.html">Actor-Critic</a></li>
<li class="toctree-l1"><a class="reference internal" href="PPO.html">Proximal Policy Optimization</a></li>
<li class="toctree-l1"><a class="reference internal" href="DDPG.html">Deep Deterministic Policy Gradient</a></li>
<li class="toctree-l1"><a class="reference internal" href="TD3.html">TD3</a></li>
<li class="toctree-l1"><a class="reference internal" href="SAC.html">Soft Actor Critic (SAC)</a></li>
<li class="toctree-l1"><a class="reference internal" href="DDPGfD.html">DDPGfD</a></li>
<li class="toctree-l1"><a class="reference internal" href="BC.html">Behavior Cloning (without HER)</a></li>
<li class="toctree-l1"><a class="reference internal" href="dqn.html">Deep Q Network (DQN)</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Double DQN</a></li>
<li class="toctree-l1"><a class="reference internal" href="per.html">Prioritized Experience Replay (PER)</a></li>
<li class="toctree-l1"><a class="reference internal" href="dueling.html">Dueling Network</a></li>
<li class="toctree-l1"><a class="reference internal" href="noisy_net.html">Noisy Networks for Exploration</a></li>
<li class="toctree-l1"><a class="reference internal" href="categorical_dqn.html">Categorical DQN</a></li>
<li class="toctree-l1"><a class="reference internal" href="n_step_learning.html">N-Step Learning</a></li>
<li class="toctree-l1"><a class="reference internal" href="rainbow.html">Rainbow</a></li>
</ul>

  </div>
</nav>
    </div>
  </div>
  

  
  <div class="sidebar-end-items sidebar-primary__section">
    <div class="sidebar-end-items__item">
    </div>
  </div>

      </div>
      <main class="bd-main">
        
        
<div class="bd-content">
    <div class="bd-article-container">
        
        <div class="bd-header-article">
            
        </div>
        
        
        <article class="bd-article" role="main">
             <section class="tex2jax_ignore mathjax_ignore" id="double-dqn">
<h1>02. Double DQN<a class="headerlink" href="#double-dqn" title="Permalink to this heading">#</a></h1>
<p><a class="reference external" href="https://arxiv.org/pdf/1509.06461.pdf">van Hasselt et al., “Deep Reinforcement Learning with Double Q-learning.” arXiv preprint arXiv:1509.06461, 2015.</a></p>
<p>Let’s take a close look at the difference between DQN and Double-DQN. The max operator in standard Q-learning and DQN uses the same values both to select and to evaluate an action. This makes it more likely to select overestimated values, resulting in overoptimistic value estimates.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\theta_{t+1} = \theta_t + \alpha \big(Y_t^Q - Q(S_t, A_t; \theta_t)\big) \cdot \nabla_{\theta_t} Q(S_t, A_t; \theta_t),\\
\text{where } \alpha \text{ is a scalar step size and the target } Y_t^Q \text{is defined as }\\
Y_t^Q = R_{t+1} + \gamma \max_a Q(S_{t+1}, a; \theta_t).
\end{split}\]</div>
<p>In Double Q-learning (<a class="reference external" href="https://papers.nips.cc/paper/3964-double-q-learning.pdf">van Hasselt 2010</a>), two value functions are learned by assigning experiences randomly to update one of the two value functions, resulting in two sets of weights, <span class="math notranslate nohighlight">\(\theta\)</span> and <span class="math notranslate nohighlight">\(\theta'\)</span>. For each update, one set of weights is used to determine the greedy policy and the other to determine its value. For a clear comparison, we can untangle the selection and evaluation in Q-learning and rewrite DQN’s target as</p>
<div class="math notranslate nohighlight">
\[
Y_t^Q = R_{t+1} + \gamma Q(S_{t+1}, \arg\max_a Q(S_{t+1}, a; \theta_t); \theta_t).
\]</div>
<p>The Double Q-learning error can then be written as</p>
<div class="math notranslate nohighlight">
\[
Y_t^{DoubleQ} = R_{t+1} + \gamma Q(S_{t+1}, \arg\max_a Q(S_{t+1}, a; \theta_t); \theta_t').
\]</div>
<p>The idea of Double Q-learning is to reduce overestimations by decomposing the max operation in the target into action selection and action evaluation. Although not fully decoupled, the target network in the DQN architecture provides a natural candidate for the second value function, without having to introduce additional networks. In conclusion, the weights of the second network <span class="math notranslate nohighlight">\(\theta_t'\)</span> are replaced with the weights of the target network for the evaluation of the current greedy policy. This makes just a small change in calculating the target value of DQN loss.</p>
<section id="dqn">
<h2>DQN:<a class="headerlink" href="#dqn" title="Permalink to this heading">#</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">target</span> <span class="o">=</span> <span class="n">reward</span> <span class="o">+</span> <span class="n">gamma</span> <span class="o">*</span> <span class="n">dqn_target</span><span class="p">(</span><span class="n">next_state</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">keepdim</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</section>
<section id="doubledqn">
<h2>DoubleDQN:<a class="headerlink" href="#doubledqn" title="Permalink to this heading">#</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">selected_action</span> <span class="o">=</span> <span class="n">dqn</span><span class="p">(</span><span class="n">next_state</span><span class="p">)</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">keepdim</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">target</span> <span class="o">=</span> <span class="n">reward</span> <span class="o">+</span> <span class="n">gamma</span> <span class="o">*</span> <span class="n">dqn_target</span><span class="p">(</span><span class="n">next_state</span><span class="p">)</span><span class="o">.</span><span class="n">gather</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">selected_action</span><span class="p">)</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">List</span><span class="p">,</span> <span class="n">Tuple</span>

<span class="kn">import</span> <span class="nn">gym</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">torch</span>
<span class="kn">import</span> <span class="nn">torch.nn</span> <span class="k">as</span> <span class="nn">nn</span>
<span class="kn">import</span> <span class="nn">torch.nn.functional</span> <span class="k">as</span> <span class="nn">F</span>
<span class="kn">import</span> <span class="nn">torch.optim</span> <span class="k">as</span> <span class="nn">optim</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">clear_output</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="replay-buffer">
<h2>Replay buffer<a class="headerlink" href="#replay-buffer" title="Permalink to this heading">#</a></h2>
<p>Please see <em>01.dqn.ipynb</em> for detailed description.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">ReplayBuffer</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;A simple numpy replay buffer.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obs_dim</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">size</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">batch_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">32</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">obs_buf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">size</span><span class="p">,</span> <span class="n">obs_dim</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">next_obs_buf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">size</span><span class="p">,</span> <span class="n">obs_dim</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">acts_buf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">size</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rews_buf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">size</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">done_buf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">max_size</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">batch_size</span> <span class="o">=</span> <span class="n">size</span><span class="p">,</span> <span class="n">batch_size</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ptr</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span>

    <span class="k">def</span> <span class="nf">store</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">obs</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
        <span class="n">act</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> 
        <span class="n">rew</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> 
        <span class="n">next_obs</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> 
        <span class="n">done</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">obs_buf</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">ptr</span><span class="p">]</span> <span class="o">=</span> <span class="n">obs</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">next_obs_buf</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">ptr</span><span class="p">]</span> <span class="o">=</span> <span class="n">next_obs</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">acts_buf</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">ptr</span><span class="p">]</span> <span class="o">=</span> <span class="n">act</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rews_buf</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">ptr</span><span class="p">]</span> <span class="o">=</span> <span class="n">rew</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">done_buf</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">ptr</span><span class="p">]</span> <span class="o">=</span> <span class="n">done</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ptr</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ptr</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_size</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_size</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">sample_batch</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]:</span>
        <span class="n">idxs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">batch_size</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">dict</span><span class="p">(</span><span class="n">obs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">obs_buf</span><span class="p">[</span><span class="n">idxs</span><span class="p">],</span>
                    <span class="n">next_obs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">next_obs_buf</span><span class="p">[</span><span class="n">idxs</span><span class="p">],</span>
                    <span class="n">acts</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">acts_buf</span><span class="p">[</span><span class="n">idxs</span><span class="p">],</span>
                    <span class="n">rews</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">rews_buf</span><span class="p">[</span><span class="n">idxs</span><span class="p">],</span>
                    <span class="n">done</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">done_buf</span><span class="p">[</span><span class="n">idxs</span><span class="p">])</span>

    <span class="k">def</span> <span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="network">
<h2>Network<a class="headerlink" href="#network" title="Permalink to this heading">#</a></h2>
<p>We are going to use a simple network architecture with three fully connected layers and two non-linearity functions (ReLU).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Network</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">in_dim</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">out_dim</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Initialization.&quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Network</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">layers</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Sequential</span><span class="p">(</span>
            <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="n">in_dim</span><span class="p">,</span> <span class="mi">128</span><span class="p">),</span> 
            <span class="n">nn</span><span class="o">.</span><span class="n">ReLU</span><span class="p">(),</span>
            <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">128</span><span class="p">,</span> <span class="mi">128</span><span class="p">),</span> 
            <span class="n">nn</span><span class="o">.</span><span class="n">ReLU</span><span class="p">(),</span> 
            <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">128</span><span class="p">,</span> <span class="n">out_dim</span><span class="p">)</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Forward method implementation.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">layers</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="double-dqn-agent">
<h2>Double DQN Agent<a class="headerlink" href="#double-dqn-agent" title="Permalink to this heading">#</a></h2>
<p>Here is a summary of DQNAgent class.</p>
<table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Method</p></th>
<th class="head"><p>Note</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>select_action</p></td>
<td><p>select an action from the input state.</p></td>
</tr>
<tr class="row-odd"><td><p>step</p></td>
<td><p>take an action and return the response of the env.</p></td>
</tr>
<tr class="row-even"><td><p>compute_dqn_loss</p></td>
<td><p>return dqn loss.</p></td>
</tr>
<tr class="row-odd"><td><p>update_model</p></td>
<td><p>update the model by gradient descent.</p></td>
</tr>
<tr class="row-even"><td><p>target_hard_update</p></td>
<td><p>hard update from the local model to the target model.</p></td>
</tr>
<tr class="row-odd"><td><p>train</p></td>
<td><p>train the agent during num_frames.</p></td>
</tr>
<tr class="row-even"><td><p>test</p></td>
<td><p>test the agent (1 episode).</p></td>
</tr>
<tr class="row-odd"><td><p>plot</p></td>
<td><p>plot the training progresses.</p></td>
</tr>
</tbody>
</table>
<p>We use <code class="docutils literal notranslate"><span class="pre">self.dqn</span></code> instead of <code class="docutils literal notranslate"><span class="pre">self.dqn_target</span></code> for action selection.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>
        <span class="n">next_q_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dqn_target</span><span class="p">(</span><span class="n">next_state</span><span class="p">)</span><span class="o">.</span><span class="n">gather</span><span class="p">(</span>
            <span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dqn</span><span class="p">(</span><span class="n">next_state</span><span class="p">)</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">keepdim</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># Double DQN</span>
        <span class="p">)</span><span class="o">.</span><span class="n">detach</span><span class="p">()</span>
        <span class="n">mask</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">done</span>
        <span class="n">target</span> <span class="o">=</span> <span class="p">(</span><span class="n">reward</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">gamma</span> <span class="o">*</span> <span class="n">next_q_value</span> <span class="o">*</span> <span class="n">mask</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">DQNAgent</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;DQN Agent interacting with environment.</span>
<span class="sd">    </span>
<span class="sd">    Attribute:</span>
<span class="sd">        env (gym.Env): openAI Gym environment</span>
<span class="sd">        memory (ReplayBuffer): replay memory to store transitions</span>
<span class="sd">        batch_size (int): batch size for sampling</span>
<span class="sd">        epsilon (float): parameter for epsilon greedy policy</span>
<span class="sd">        epsilon_decay (float): step size to decrease epsilon</span>
<span class="sd">        max_epsilon (float): max value of epsilon</span>
<span class="sd">        min_epsilon (float): min value of epsilon</span>
<span class="sd">        target_update (int): period for target model&#39;s hard update</span>
<span class="sd">        gamma (float): discount factor</span>
<span class="sd">        dqn (Network): model to train and select actions</span>
<span class="sd">        dqn_target (Network): target model to update</span>
<span class="sd">        optimizer (torch.optim): optimizer for training dqn</span>
<span class="sd">        transition (list): transition information including </span>
<span class="sd">                           state, action, reward, next_state, done</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> 
        <span class="n">env</span><span class="p">:</span> <span class="n">gym</span><span class="o">.</span><span class="n">Env</span><span class="p">,</span>
        <span class="n">memory_size</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="n">batch_size</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="n">target_update</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="n">epsilon_decay</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
        <span class="n">max_epsilon</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
        <span class="n">min_epsilon</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">,</span>
        <span class="n">gamma</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.99</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Initialization.</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            env (gym.Env): openAI Gym environment</span>
<span class="sd">            memory_size (int): length of memory</span>
<span class="sd">            batch_size (int): batch size for sampling</span>
<span class="sd">            target_update (int): period for target model&#39;s hard update</span>
<span class="sd">            epsilon_decay (float): step size to decrease epsilon</span>
<span class="sd">            lr (float): learning rate</span>
<span class="sd">            max_epsilon (float): max value of epsilon</span>
<span class="sd">            min_epsilon (float): min value of epsilon</span>
<span class="sd">            gamma (float): discount factor</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">obs_dim</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">observation_space</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">action_dim</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">action_space</span><span class="o">.</span><span class="n">n</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">env</span> <span class="o">=</span> <span class="n">env</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">memory</span> <span class="o">=</span> <span class="n">ReplayBuffer</span><span class="p">(</span><span class="n">obs_dim</span><span class="p">,</span> <span class="n">memory_size</span><span class="p">,</span> <span class="n">batch_size</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">batch_size</span> <span class="o">=</span> <span class="n">batch_size</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">epsilon</span> <span class="o">=</span> <span class="n">max_epsilon</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">epsilon_decay</span> <span class="o">=</span> <span class="n">epsilon_decay</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">max_epsilon</span> <span class="o">=</span> <span class="n">max_epsilon</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">min_epsilon</span> <span class="o">=</span> <span class="n">min_epsilon</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">target_update</span> <span class="o">=</span> <span class="n">target_update</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gamma</span> <span class="o">=</span> <span class="n">gamma</span>
        
        <span class="c1"># device: cpu / gpu</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">device</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">(</span>
            <span class="s2">&quot;cuda&quot;</span> <span class="k">if</span> <span class="n">torch</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">is_available</span><span class="p">()</span> <span class="k">else</span> <span class="s2">&quot;cpu&quot;</span>
        <span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>

        <span class="c1"># networks: dqn, dqn_target</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dqn</span> <span class="o">=</span> <span class="n">Network</span><span class="p">(</span><span class="n">obs_dim</span><span class="p">,</span> <span class="n">action_dim</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dqn_target</span> <span class="o">=</span> <span class="n">Network</span><span class="p">(</span><span class="n">obs_dim</span><span class="p">,</span> <span class="n">action_dim</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dqn_target</span><span class="o">.</span><span class="n">load_state_dict</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dqn</span><span class="o">.</span><span class="n">state_dict</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dqn_target</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
        
        <span class="c1"># optimizer</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">optimizer</span> <span class="o">=</span> <span class="n">optim</span><span class="o">.</span><span class="n">Adam</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dqn</span><span class="o">.</span><span class="n">parameters</span><span class="p">())</span>

        <span class="c1"># transition to store in memory</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">transition</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        
        <span class="c1"># mode: train / test</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">is_test</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="k">def</span> <span class="nf">select_action</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Select an action from the input state.&quot;&quot;&quot;</span>
        <span class="c1"># epsilon greedy policy</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">epsilon</span> <span class="o">&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">():</span>
            <span class="n">selected_action</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">action_space</span><span class="o">.</span><span class="n">sample</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">selected_action</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dqn</span><span class="p">(</span>
                <span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span><span class="p">(</span><span class="n">state</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>
            <span class="p">)</span><span class="o">.</span><span class="n">argmax</span><span class="p">()</span>
            <span class="n">selected_action</span> <span class="o">=</span> <span class="n">selected_action</span><span class="o">.</span><span class="n">detach</span><span class="p">()</span><span class="o">.</span><span class="n">cpu</span><span class="p">()</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span>
        
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_test</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">transition</span> <span class="o">=</span> <span class="p">[</span><span class="n">state</span><span class="p">,</span> <span class="n">selected_action</span><span class="p">]</span>
        
        <span class="k">return</span> <span class="n">selected_action</span>

    <span class="k">def</span> <span class="nf">step</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">action</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">,</span> <span class="nb">bool</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Take an action and return the response of the env.&quot;&quot;&quot;</span>
        <span class="n">next_state</span><span class="p">,</span> <span class="n">reward</span><span class="p">,</span> <span class="n">done</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">action</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_test</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">transition</span> <span class="o">+=</span> <span class="p">[</span><span class="n">reward</span><span class="p">,</span> <span class="n">next_state</span><span class="p">,</span> <span class="n">done</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">memory</span><span class="o">.</span><span class="n">store</span><span class="p">(</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">transition</span><span class="p">)</span>
    
        <span class="k">return</span> <span class="n">next_state</span><span class="p">,</span> <span class="n">reward</span><span class="p">,</span> <span class="n">done</span>

    <span class="k">def</span> <span class="nf">update_model</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Update the model by gradient descent.&quot;&quot;&quot;</span>
        <span class="n">samples</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">memory</span><span class="o">.</span><span class="n">sample_batch</span><span class="p">()</span>

        <span class="n">loss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_compute_dqn_loss</span><span class="p">(</span><span class="n">samples</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">optimizer</span><span class="o">.</span><span class="n">zero_grad</span><span class="p">()</span>
        <span class="n">loss</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">optimizer</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">loss</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>
        
    <span class="k">def</span> <span class="nf">train</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">num_frames</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">plotting_interval</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">200</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Train the agent.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">is_test</span> <span class="o">=</span> <span class="kc">False</span>
        
        <span class="n">state</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
        <span class="n">update_cnt</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">epsilons</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">losses</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">scores</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">score</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="k">for</span> <span class="n">frame_idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">num_frames</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
            <span class="n">action</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">select_action</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
            <span class="n">next_state</span><span class="p">,</span> <span class="n">reward</span><span class="p">,</span> <span class="n">done</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">action</span><span class="p">)</span>

            <span class="n">state</span> <span class="o">=</span> <span class="n">next_state</span>
            <span class="n">score</span> <span class="o">+=</span> <span class="n">reward</span>

            <span class="c1"># if episode ends</span>
            <span class="k">if</span> <span class="n">done</span><span class="p">:</span>
                <span class="n">state</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
                <span class="n">scores</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">score</span><span class="p">)</span>
                <span class="n">score</span> <span class="o">=</span> <span class="mi">0</span>

            <span class="c1"># if training is ready</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">memory</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">batch_size</span><span class="p">:</span>
                <span class="n">loss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">update_model</span><span class="p">()</span>
                <span class="n">losses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">loss</span><span class="p">)</span>
                <span class="n">update_cnt</span> <span class="o">+=</span> <span class="mi">1</span>
                
                <span class="c1"># linearly decrease epsilon</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">epsilon</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">min_epsilon</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">epsilon</span> <span class="o">-</span> <span class="p">(</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">max_epsilon</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">min_epsilon</span>
                    <span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">epsilon_decay</span>
                <span class="p">)</span>
                <span class="n">epsilons</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">epsilon</span><span class="p">)</span>
                
                <span class="c1"># if hard update is needed</span>
                <span class="k">if</span> <span class="n">update_cnt</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">target_update</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_target_hard_update</span><span class="p">()</span>

            <span class="c1"># plotting</span>
            <span class="k">if</span> <span class="n">frame_idx</span> <span class="o">%</span> <span class="n">plotting_interval</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_plot</span><span class="p">(</span><span class="n">frame_idx</span><span class="p">,</span> <span class="n">scores</span><span class="p">,</span> <span class="n">losses</span><span class="p">,</span> <span class="n">epsilons</span><span class="p">)</span>
                
        <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
                
    <span class="k">def</span> <span class="nf">test</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">video_folder</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Test the agent.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">is_test</span> <span class="o">=</span> <span class="kc">True</span>
        
        <span class="c1"># for recording a video</span>
        <span class="n">naive_env</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">env</span> <span class="o">=</span> <span class="n">gym</span><span class="o">.</span><span class="n">wrappers</span><span class="o">.</span><span class="n">RecordVideo</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="p">,</span> <span class="n">video_folder</span><span class="o">=</span><span class="n">video_folder</span><span class="p">)</span>
        
        <span class="n">state</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
        <span class="n">done</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">score</span> <span class="o">=</span> <span class="mi">0</span>
        
        <span class="k">while</span> <span class="ow">not</span> <span class="n">done</span><span class="p">:</span>
            <span class="n">action</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">select_action</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
            <span class="n">next_state</span><span class="p">,</span> <span class="n">reward</span><span class="p">,</span> <span class="n">done</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">action</span><span class="p">)</span>

            <span class="n">state</span> <span class="o">=</span> <span class="n">next_state</span>
            <span class="n">score</span> <span class="o">+=</span> <span class="n">reward</span>
        
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;score: &quot;</span><span class="p">,</span> <span class="n">score</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        
        <span class="c1"># reset</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">env</span> <span class="o">=</span> <span class="n">naive_env</span>

    <span class="k">def</span> <span class="nf">_compute_dqn_loss</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">samples</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Return dqn loss.&quot;&quot;&quot;</span>
        <span class="n">device</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">device</span>  <span class="c1"># for shortening the following lines</span>
        <span class="n">state</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span><span class="p">(</span><span class="n">samples</span><span class="p">[</span><span class="s2">&quot;obs&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
        <span class="n">next_state</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span><span class="p">(</span><span class="n">samples</span><span class="p">[</span><span class="s2">&quot;next_obs&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
        <span class="n">action</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">LongTensor</span><span class="p">(</span><span class="n">samples</span><span class="p">[</span><span class="s2">&quot;acts&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
        <span class="n">reward</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span><span class="p">(</span><span class="n">samples</span><span class="p">[</span><span class="s2">&quot;rews&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
        <span class="n">done</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span><span class="p">(</span><span class="n">samples</span><span class="p">[</span><span class="s2">&quot;done&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
        
        <span class="c1"># G_t   = r + gamma * v(s_{t+1})  if state != Terminal</span>
        <span class="c1">#       = r                       otherwise</span>
        <span class="n">curr_q_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dqn</span><span class="p">(</span><span class="n">state</span><span class="p">)</span><span class="o">.</span><span class="n">gather</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">action</span><span class="p">)</span>
        <span class="n">next_q_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dqn_target</span><span class="p">(</span><span class="n">next_state</span><span class="p">)</span><span class="o">.</span><span class="n">gather</span><span class="p">(</span>  <span class="c1"># Double DQN</span>
            <span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dqn</span><span class="p">(</span><span class="n">next_state</span><span class="p">)</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">keepdim</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="p">)</span><span class="o">.</span><span class="n">detach</span><span class="p">()</span>
        <span class="n">mask</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">done</span>
        <span class="n">target</span> <span class="o">=</span> <span class="p">(</span><span class="n">reward</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">gamma</span> <span class="o">*</span> <span class="n">next_q_value</span> <span class="o">*</span> <span class="n">mask</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>

        <span class="c1"># calculate dqn loss</span>
        <span class="n">loss</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">smooth_l1_loss</span><span class="p">(</span><span class="n">curr_q_value</span><span class="p">,</span> <span class="n">target</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">loss</span>
    
    <span class="k">def</span> <span class="nf">_target_hard_update</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Hard update: target &lt;- local.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dqn_target</span><span class="o">.</span><span class="n">load_state_dict</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dqn</span><span class="o">.</span><span class="n">state_dict</span><span class="p">())</span>
                
    <span class="k">def</span> <span class="nf">_plot</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> 
        <span class="n">frame_idx</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> 
        <span class="n">scores</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> 
        <span class="n">losses</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> 
        <span class="n">epsilons</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Plot the training progresses.&quot;&quot;&quot;</span>
        <span class="n">clear_output</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">131</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;frame </span><span class="si">%s</span><span class="s1">. score: </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">frame_idx</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">scores</span><span class="p">[</span><span class="o">-</span><span class="mi">10</span><span class="p">:])))</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">scores</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">132</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;loss&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">losses</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">133</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;epsilons&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">epsilons</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="environment">
<h2>Environment<a class="headerlink" href="#environment" title="Permalink to this heading">#</a></h2>
<p>You can see the <a class="reference external" href="https://github.com/openai/gym/blob/master/gym/envs/classic_control/cartpole.py">code</a> and <a class="reference external" href="https://github.com/openai/gym/blob/master/gym/envs/__init__.py#L53">configurations</a> of CartPole-v0 from OpenAI’s repository.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># environment</span>
<span class="n">env_id</span> <span class="o">=</span> <span class="s2">&quot;CartPole-v0&quot;</span>
<span class="n">env</span> <span class="o">=</span> <span class="n">gym</span><span class="o">.</span><span class="n">make</span><span class="p">(</span><span class="n">env_id</span><span class="p">)</span>
<span class="k">if</span> <span class="n">IN_COLAB</span><span class="p">:</span>
    <span class="n">env</span> <span class="o">=</span> <span class="n">gym</span><span class="o">.</span><span class="n">wrappers</span><span class="o">.</span><span class="n">Monitor</span><span class="p">(</span><span class="n">env</span><span class="p">,</span> <span class="s2">&quot;videos&quot;</span><span class="p">,</span> <span class="n">force</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="set-random-seed">
<h2>Set random seed<a class="headerlink" href="#set-random-seed" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">seed</span> <span class="o">=</span> <span class="mi">777</span>

<span class="k">def</span> <span class="nf">seed_torch</span><span class="p">(</span><span class="n">seed</span><span class="p">):</span>
    <span class="n">torch</span><span class="o">.</span><span class="n">manual_seed</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">torch</span><span class="o">.</span><span class="n">backends</span><span class="o">.</span><span class="n">cudnn</span><span class="o">.</span><span class="n">enabled</span><span class="p">:</span>
        <span class="n">torch</span><span class="o">.</span><span class="n">backends</span><span class="o">.</span><span class="n">cudnn</span><span class="o">.</span><span class="n">benchmark</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">torch</span><span class="o">.</span><span class="n">backends</span><span class="o">.</span><span class="n">cudnn</span><span class="o">.</span><span class="n">deterministic</span> <span class="o">=</span> <span class="kc">True</span>

<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
<span class="n">seed_torch</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
<span class="n">env</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[777]
</pre></div>
</div>
</div>
</div>
</section>
<section id="initialize">
<h2>Initialize<a class="headerlink" href="#initialize" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># parameters</span>
<span class="n">num_frames</span> <span class="o">=</span> <span class="mi">20000</span>
<span class="n">memory_size</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">batch_size</span> <span class="o">=</span> <span class="mi">32</span>
<span class="n">target_update</span> <span class="o">=</span> <span class="mi">200</span>
<span class="n">epsilon_decay</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2000</span>

<span class="c1"># train</span>
<span class="n">agent</span> <span class="o">=</span> <span class="n">DQNAgent</span><span class="p">(</span><span class="n">env</span><span class="p">,</span> <span class="n">memory_size</span><span class="p">,</span> <span class="n">batch_size</span><span class="p">,</span> <span class="n">target_update</span><span class="p">,</span> <span class="n">epsilon_decay</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>cpu
</pre></div>
</div>
</div>
</div>
</section>
<section id="train">
<h2>Train<a class="headerlink" href="#train" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">agent</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><span class="n">num_frames</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/e67ba63793596b8ec42f0b096f3b4ae53e69594c45b21502ad3370e65950dd59.png" src="../_images/e67ba63793596b8ec42f0b096f3b4ae53e69594c45b21502ad3370e65950dd59.png" />
</div>
</div>
</section>
<section id="test">
<h2>Test<a class="headerlink" href="#test" title="Permalink to this heading">#</a></h2>
<p>Run the trained agent (1 episode).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">video_folder</span><span class="o">=</span><span class="s2">&quot;videos/double_q&quot;</span>
<span class="n">agent</span><span class="o">.</span><span class="n">test</span><span class="p">(</span><span class="n">video_folder</span><span class="o">=</span><span class="n">video_folder</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>score:  200.0
</pre></div>
</div>
</div>
</div>
</section>
<section id="render">
<h2>Render<a class="headerlink" href="#render" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">base64</span>
<span class="kn">import</span> <span class="nn">glob</span>
<span class="kn">import</span> <span class="nn">io</span>
<span class="kn">import</span> <span class="nn">os</span>

<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">HTML</span><span class="p">,</span> <span class="n">display</span>


<span class="k">def</span> <span class="nf">ipython_show_video</span><span class="p">(</span><span class="n">path</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Show a video at `path` within IPython Notebook.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">NameError</span><span class="p">(</span><span class="s2">&quot;Cannot access: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">path</span><span class="p">))</span>

    <span class="n">video</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s2">&quot;r+b&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
    <span class="n">encoded</span> <span class="o">=</span> <span class="n">base64</span><span class="o">.</span><span class="n">b64encode</span><span class="p">(</span><span class="n">video</span><span class="p">)</span>

    <span class="n">display</span><span class="p">(</span><span class="n">HTML</span><span class="p">(</span>
        <span class="n">data</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        &lt;video width=&quot;320&quot; height=&quot;240&quot; alt=&quot;test&quot; controls&gt;</span>
<span class="s2">        &lt;source src=&quot;data:video/mp4;base64,</span><span class="si">{0}</span><span class="s2">&quot; type=&quot;video/mp4&quot;/&gt;</span>
<span class="s2">        &lt;/video&gt;</span>
<span class="s2">        &quot;&quot;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">encoded</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;ascii&quot;</span><span class="p">))</span>
    <span class="p">))</span>


<span class="k">def</span> <span class="nf">show_latest_video</span><span class="p">(</span><span class="n">video_folder</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Show the most recently recorded video from video folder.&quot;&quot;&quot;</span>
    <span class="n">list_of_files</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">video_folder</span><span class="p">,</span> <span class="s2">&quot;*.mp4&quot;</span><span class="p">))</span>
    <span class="n">latest_file</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">list_of_files</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">getctime</span><span class="p">)</span>
    <span class="n">ipython_show_video</span><span class="p">(</span><span class="n">latest_file</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">latest_file</span>


<span class="n">latest_file</span> <span class="o">=</span> <span class="n">show_latest_video</span><span class="p">(</span><span class="n">video_folder</span><span class="o">=</span><span class="n">video_folder</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Played:&quot;</span><span class="p">,</span> <span class="n">latest_file</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
        <video width="320" height="240" alt="test" controls>
        <source src="data:video/mp4;base64,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AAABAAABAAAAAAEAAAUAAAAAAQAAAgAAAAABAAAAAAAAAAEAAAEAAAAAAQAABQAAAAABAAACAAAAAAEAAAAAAAAAAQAAAQAAAAABAAAFAAAAAAEAAAIAAAAAAQAAAAAAAAABAAABAAAAAAEAAAUAAAAAAQAAAgAAAAABAAAAAAAAAAEAAAEAAAAAAQAABQAAAAABAAACAAAAAAEAAAAAAAAAAQAAAQAAAAABAAAFAAAAAAEAAAIAAAAAAQAAAAAAAAABAAABAAAAAAEAAAUAAAAAAQAAAgAAAAABAAAAAAAAAAEAAAEAAAAAAQAABQAAAAABAAACAAAAAAEAAAAAAAAAAQAAAQAAAAABAAAFAAAAAAEAAAIAAAAAAQAAAAAAAAABAAABAAAAAAEAAAUAAAAAAQAAAgAAAAABAAAAAAAAAAEAAAEAAAAAAQAABQAAAAABAAACAAAAAAEAAAAAAAAAAQAAAQAAAAABAAAFAAAAAAEAAAIAAAAAAQAAAAAAAAABAAABAAAAAAEAAAUAAAAAAQAAAgAAAAABAAAAAAAAAAEAAAEAAAAAAQAABQAAAAABAAACAAAAAAEAAAAAAAAAAQAAAQAAAAABAAAFAAAAAAEAAAIAAAAAAQAAAAAAAAABAAABAAAAAAEAAAUAAAAAAQAAAgAAAAABAAAAAAAAAAEAAAEAAAAAAQAABQAAAAABAAACAAAAAAEAAAAAAAAAAQAAAQAAAAABAAAFAAAAAAEAAAIAAAAAAQAAAAAAAAABAAABAAAAAAEAAAUAAAAAAQAAAgAAAAABAAAAAAAAAAEAAAEAAAAAAQAABQAAAAABAAACAAAAAAEAAAAAAAAAAQAAAQAAAAABAAAFAAAAAAEAAAIAAAAAAQAAAAAAAAABAAABAAAAAAEAAAUAAAAAAQAAAgAAAAABAAAAAAAAAAEAAAEAAAAAAQAABQAAAAABAAACAAAAAAEAAAAAAAAAAQAAAQAAAAABAAAFAAAAAAEAAAIAAAAAAQAAAAAAAAABAAABAAAAAAEAAAUAAAAAAQAAAgAAAAABAAAAAAAAAAEAAAEAAAAAAQAABQAAAAABAAACAAAAAAEAAAAAAAAAAQAAAQAAAAABAAAFAAAAAAEAAAIAAAAAAQAAAAAAAAABAAABAAAAAAEAAAUAAAAAAQAAAgAAAAABAAAAAAAAAAEAAAEAAAAAAQAABQAAAAABAAACAAAAAAEAAAAAAAAAAQAAAQAAAAABAAAFAAAAAAEAAAIAAAAAAQAAAAAAAAABAAABAAAAAAEAAAUAAAAAAQAAAgAAAAABAAAAAAAAAAEAAAEAAAAAAQAABQAAAAABAAACAAAAAAEAAAAAAAAAAQAAAQAAAAABAAAFAAAAAAEAAAIAAAAAAQAAAAAAAAABAAABAAAAAAEAAAUAAAAAAQAAAgAAAAABAAAAAAAAAAEAAAEAAAAAAQAABQAAAAABAAACAAAAAAEAAAAAAAAAAQAAAQAAAAABAAAFAAAAAAEAAAIAAAAAAQAAAAAAAAABAAABAAAAAAEAAAUAAAAAAQAAAgAAAAABAAAAAAAAAAEAAAEAAAAAAQAABQAAAAABAAACAAAAAAEAAAAAAAAAAQAAAQAAAAABAAAFAAAAAAEAAAIAAAAAAQAAAAAAAAABAAABAAAAAAEAAAUAAAAAAQAAAgAAAAABAAAAAAAAAAEAAAEAAAAAHHN0c2MAAAAAAAAAAQAAAAEAAADJAAAAAQAAAzhzdHN6AAAAAAAAAAAAAADJAAAGBAAAAOIAAAChAAAAZAAAAFMAAACyAAAAbAAAAEgAAABSAAAAqgAAAF8AAABKAAAAQwAAAGUAAABiAAAAPQAAADYAAABfAAAATwAAAEkAAAAzAAAAgwAAAFkAAAA6AAAAOgAAAFsAAABhAAAASgAAAEsAAABeAAAAYgAAAEIAAAA2AAAARgAAAFUAAAA2AAAAUQAAAHwAAABZAAAASgAAAEUAAAA5AAAAWQAAADMAAABAAAAAYAAAAFEAAAA/AAAAOgAAAJ4AAABkAAAANgAAAEYAAADCAAAAvwAAAIMAAABJAAAA1AAAAIgAAABhAAAATQAAALMAAACKAAAASgAAAF0AAAB8AAAAdgAAAE0AAABeAAAA1wAAAI8AAAA7AAAAkAAAAKoAAACfAAAAaQAAAFsAAACgAAAAZgAAAD0AAABNAAAAVwAAAG0AAABCAAAAUgAAAIcAAABnAAAARwAAADcAAACwAAAAVQAAAE8AAABgAAAAfwAAAJYAAABUAAAAYwAAALIAAACBAAAAUAAAAGYAAACEAAAAYQAAAE4AAABHAAAAjAAAAF0AAABMAAAARAAAAH4AAABsAAAARQAAAD0AAACLAAAAbQAAAD4AAABYAAAA1AAAAKIAAAByAAAAhQAAAKkAAACDAAAATgAAAGEAAACRAAAAdgAAAFkAAABZAAAAdAAAAGcAAABTAAAAUQAAAG8AAABSAAAAPQAAAEoAAACIAAAAbgAAAEAAAABWAAAA1QAAAH4AAABIAAAAcQAAAJcAAACgAAAAdAAAAHsAAACeAAAAngAAAGEAAABfAAAApAAAAIoAAABXAAAAbwAAAJwAAACcAAAAcwAAAGEAAACAAAAAcQAAAF8AAABkAAAAnAAAALcAAABnAAAAeQAAAMQAAACsAAAAjQAAAHIAAACzAAAAjwAAAGkAAABmAAAArQAAAJEAAABgAAAAaAAAALgAAACdAAAAmQAAAI0AAADCAAAAjgAAAHMAAAB2AAAAzwAAAJIAAAByAAAAdgAAAJIAAAC3AAAAgAAAAJMAAAC4AAAAxQAAAIUAAAB1AAAAFHN0Y28AAAAAAAAAAQAAADAAAABidWR0YQAAAFptZXRhAAAAAAAAACFoZGxyAAAAAAAAAABtZGlyYXBwbAAAAAAAAAAAAAAAAC1pbHN0AAAAJal0b28AAAAdZGF0YQAAAAEAAAAATGF2ZjU4Ljc2LjEwMA==" type="video/mp4"/>
        </video>
        </div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Played: videos/double_q/rl-video-episode-0.mp4
</pre></div>
</div>
</div>
</div>
</section>
</section>

<div class="section">
   
</div>

            
            
        </article>
        
        
        
        <footer class="bd-footer-article">
            
            <!-- Previous / next buttons -->
<div class='prev-next-area'>
  <a class='left-prev' id="prev-link" href="dqn.html" title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
          <p class="prev-next-subtitle">previous</p>
          <p class="prev-next-title">01. DQN</p>
      </div>
  </a>
  <a class='right-next' id="next-link" href="per.html" title="next page">
  <div class="prev-next-info">
      <p class="prev-next-subtitle">next</p>
      <p class="prev-next-title">03. Prioritized Experience Replay (PER)</p>
  </div>
  <i class="fa-solid fa-angle-right"></i>
  </a>
</div>
            
        </footer>
        
    </div>
    
    
    
    <div class="bd-sidebar-secondary bd-toc">
        
<div class="toc-item">
  
<div class="tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
</div>
<nav id="bd-toc-nav" class="page-toc">
    <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#dqn">
   DQN:
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#doubledqn">
   DoubleDQN:
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#replay-buffer">
   Replay buffer
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#network">
   Network
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#double-dqn-agent">
   Double DQN Agent
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#environment">
   Environment
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#set-random-seed">
   Set random seed
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#initialize">
   Initialize
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#train">
   Train
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#test">
   Test
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#render">
   Render
  </a>
 </li>
</ul>

</nav>
</div>

<div class="toc-item">
  
<div id="searchbox"></div>
</div>

<div class="toc-item">
  

<div class="tocsection editthispage">
    <a href="https://github.com/zclab/notebook/edit/main/docs/drlearn/double_q.ipynb">
        <i class="fa-solid fa-pencil"></i> Edit this page
    </a>
</div>

</div>

<div class="toc-item">
  
<div class="tocsection sourcelink">
    <a href="../_sources/drlearn/double_q.ipynb.txt">
        <i class="fa-solid fa-file-lines"></i> Show Source
    </a>
</div>

</div>

    </div>
    
    
</div>
<footer class="bd-footer-content">
    <div class="bd-footer-content__inner">
        
    </div>
</footer>

      </main>
    </div>
  </div>

  
    
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1e1de1a1873e13ef5536"></script>

  <footer class="bd-footer"><div class="bd-footer__inner container">
  
  <div class="footer-item">
    
<p class="copyright">
    
    
    <img src="https://img.shields.io/badge/Copyright-2021--2022 子川-blue" />
    <br>
    
</p>

  </div>
  
  <div class="footer-item">
    
<p class="sphinx-version">
    
    <a href="http://sphinx-doc.org/" target="_blank">
        <img src="https://img.shields.io/badge/Sphinx-5.2.3-blue" />
    </a>
    <a href="https://pydata-sphinx-theme.readthedocs.io/en/latest/" target="_blank">
        <img src="https://img.shields.io/badge/Theme-Pydata%20Sphinx%20Theme-blue" />
    </a>
    <br>
</p>

  </div>
  
</div>
  </footer>
  </body>
</html>